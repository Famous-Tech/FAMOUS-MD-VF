const { zokou } = require("../framework/famous");
const axios = require("axios");
const traduire = require('../framework/traduction');
const Genius = require("genius-lyrics");
const Client = new Genius.Client("jKTbbU-6X2B9yWWl-KOm7Mh3_Z6hQsgE4mmvwV3P3Qe7oNa9-hsrLxQV5l5FiAZO");

famous({ nomCom: "sondage", reaction: "‚ú®", categorie: "G√©n√©ral" }, async (dest, zk, commandeOptions) => {
  const { repondre, ms } = commandeOptions;
  const polll = commandeOptions.arg.join(' ');

  let [poll, opt] = polll.split("/");

  if (opt.split(",").length < 2) {
    return repondre(`Format incorrect.\nExemple : sondage Quelle est la r√©ponse/Option 1, Option 2`);
  }

  let options = [];
  for (let i of opt.split(',')) {
    options.push(i.trim());
  }

  await zk.sendMessage(dest.id, {
    poll: {
      name: poll.trim(),
      values: options
    }
  });
});

famous({ nomCom: "faire", reaction: "‚úåÔ∏è", categorie: "Fun" }, async (dest, zk, commandeOptions) => {
  const { repondre, ms } = commandeOptions;

  const response = await axios.get('https://nekos.life/api/v2/fact');
  const data = response.data;

  repondre(`‚óÜ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ú¶FAIRE‚ú¶‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚óÜ
*‚óá* ${data.fact}

*‚óá* Powered by *Thomas*

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚óá
‚ïë‚óá *FAIRE PAR HACKING-MD*
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê>  `);
});

famous({ nomCom: "citation1", reaction: "üóø", categorie: "fun" }, async (dest, zk, commandeOptions) => {
  const { repondre, ms } = commandeOptions;

  const response = await axios.get('https://favqs.com/api/qotd');
  const data = response.data;

  const flashhh = `
‚óÜ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ú¶CITA‚ú¶‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚óÜ
‚óá _${data.quote.body}_

‚óá *AUTHOR:* ${data.quote.author}
üí¨ Citation: ${await traduire(data.quote.body, { to: 'fr' })}
‚óá _Powered by:_ *Thomas*

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚óá
‚ïë‚óá *FAIRE PAR HACKING-MD*
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê> `;

  repondre(thomasss);
});

famous({
   nomCom: "definir",
   reaction: "üòÅ",
   categorie: "Recherche" }, async(dest, zk, commandeOptions) => {
  const { repondre, arg, ms } = commandeOptions;

  if (!arg || arg.length === 0) {
    return repondre("Veuillez fournir un terme √† d√©finir.");
  }

  const ques = arg.join(' ');

  try {
    const { data } = await axios.get(`http://api.urbandictionary.com/v0/define?term=${ques}`);
    const textt = `
    Mot : ${ques}
    D√©finition: ${await traduire(data.list[0].definition.replace(/\[/g, "").replace(/\]/g, ""), { to: 'fr' })}
    D√©finition : ${data.list[0].definition.replace(/\[/g, "").replace(/\]/g, "")}
    Exemple : ${data.list[0].example.replace(/\[/g, "").replace(/\]/g, "")}`;

    repondre(textt);
  } catch (error) {
    return repondre(`Aucun r√©sultat pour ${ques}`);
  }
});

famous({ nomCom: "lyrics",
        reaction: "‚ú®",
        categorie: "Musicsüéº" }, async (dest, zk, commandeOptions) => {
    
    const { repondre, arg, ms } = commandeOptions;  
        
    try {
        if (!arg || arg.length === 0) {
            return repondre("Veuillez me fournir le nom de la chanson.");
        }

        const question = arg.join(' ');

        const searches = await Client.songs.search(question); 
        const firstSong = searches[0]; 
        const lyrics = await firstSong.lyrics(); 

        await zk.sendMessage(dest, { text: lyrics }, { quoted: ms }); 
    } catch (error) { 
        console.log(error);
        return repondre(`Je n'ai pas trouv√© de paroles pour ${text}. Essayez de chercher une autre chanson.`);
    }
});
